(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,r=window.wp.element,n=window.wp.apiFetch;var a=e.n(n);const o="/rz-file-manager/v1",l=async(e,t)=>{try{const r=new FormData;r.append("file",t),r.append("path",e);const n=`${window.rzFileManager?.restUrl||"/wp-json"+o}/upload`,a=await fetch(n,{method:"POST",headers:{"X-WP-Nonce":window.rzFileManager?.nonce},body:r});return await a.json()}catch(e){return console.error("Error uploading file:",e),{success:!1,message:e.message}}},i=async e=>{try{return await a()({path:`${o}/delete`,method:"DELETE",data:{path:e}})}catch(e){return console.error("Error deleting item:",e),{success:!1,message:e.message}}},c=(0,r.createContext)(),s=({children:e})=>{const[n,s]=(0,r.useState)(""),[u,m]=(0,r.useState)([]),[d,f]=(0,r.useState)([]),[g,p]=(0,r.useState)(!1),[h,y]=(0,r.useState)(null),[E,v]=(0,r.useState)(null),[_,b]=(0,r.useState)("name"),[w,z]=(0,r.useState)("asc"),[C,O]=(0,r.useState)({visible:!1,x:0,y:0,item:null}),[M,j]=(0,r.useState)({isOpen:!1,file:null,content:"",isLoading:!1,error:null}),N=async()=>{p(!0),y(null);try{const e=await(async(e="")=>{try{console.log("fetchFiles called with path:",e),console.log("rzFileManager object:",window.rzFileManager);const t=`${window.rzFileManager?.restUrl}list`;console.log("Attempting standard fetch with URL:",t);const r=await fetch(`${t}?path=${encodeURIComponent(e)}`,{method:"GET",credentials:"include",headers:{"X-WP-Nonce":window.rzFileManager?.nonce,"Content-Type":"application/json"}});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()}catch(e){return console.error("Error in fetchFiles (standard fetch):",e),{success:!1,message:e.message}}})(n);if(e.success){const t=S(e.items,_,w);m(t)}else y(e.message||"Failed to load files")}catch(e){y("Error loading files: "+(e.message||"Unknown error"))}finally{p(!1)}},S=(e,t,r)=>[...e].sort(((e,n)=>{if("directory"===e.type&&"directory"!==n.type)return-1;if("directory"!==e.type&&"directory"===n.type)return 1;let a=0;return"name"===t?a=e.name.localeCompare(n.name,void 0,{numeric:!0,sensitivity:"base"}):"size"===t?a=("directory"===e.type?-1:e.size)-("directory"===n.type?-1:n.size):"modified"===t&&(a=e.modified-n.modified),"asc"===r?a:-1*a})),k=e=>{s(e),f([])};(0,r.useEffect)((()=>{N()}),[n,_,w]),(0,r.useEffect)((()=>{if(E){const e=setTimeout((()=>{v(null)}),3e3);return()=>clearTimeout(e)}}),[E]);const x=()=>{j({isOpen:!1,file:null,content:"",isLoading:!1,error:null})},P={currentPath:n,items:u,selectedItems:d,loading:g,error:h,successMessage:E,navigateTo:k,navigateToParent:()=>{if(!n)return;const e=n.split("/");e.pop();const t=e.join("/");k(t)},toggleSelectItem:e=>{f((t=>t.some((t=>t.path===e.path))?t.filter((t=>t.path!==e.path)):[...t,e]))},isItemSelected:e=>d.some((t=>t.path===e.path)),clearSelection:()=>{f([])},clearMessages:()=>{y(null),v(null)},handleCreateFolder:async e=>{p(!0),y(null);try{const t=await(async(e,t)=>{try{return await a()({path:`${o}/create-folder`,method:"POST",data:{path:e,name:t}})}catch(e){return console.error("Error creating folder:",e),{success:!1,message:e.message}}})(n,e);t.success?(v(t.message||"Folder created successfully"),await N()):y(t.message||"Failed to create folder")}catch(e){y("Error creating folder: "+(e.message||"Unknown error"))}finally{p(!1)}},handleUploadFiles:async e=>{p(!0),y(null);try{for(let t=0;t<e.length;t++){const r=e[t],a=await l(n,r);if(!a.success){y(`Failed to upload ${r.name}: ${a.message||"Unknown error"}`);break}}v("Files uploaded successfully"),await N()}catch(e){y("Error uploading files: "+(e.message||"Unknown error"))}finally{p(!1)}},handleDeleteItems:async()=>{if(0!==d.length){p(!0),y(null);try{for(const e of d){const t=await i(e.path);if(!t.success){y(`Failed to delete ${e.name}: ${t.message||"Unknown error"}`);break}}v("Items deleted successfully"),f([]),await N()}catch(e){y("Error deleting items: "+(e.message||"Unknown error"))}finally{p(!1)}}},handleRenameItem:async(e,t)=>{p(!0),y(null);try{const r=await(async(e,t)=>{try{return await a()({path:`${o}/rename`,method:"POST",data:{path:e,newName:t}})}catch(e){return console.error("Error renaming item:",e),{success:!1,message:e.message}}})(e,t);r.success?(v(r.message||"Item renamed successfully"),await N()):y(r.message||"Failed to rename item")}catch(e){y("Error renaming item: "+(e.message||"Unknown error"))}finally{p(!1)}},reloadItems:N,sortKey:_,sortDirection:w,setSort:e=>{const t=_===e&&"asc"===w?"desc":"asc";b(e),z(t),m((r=>S(r,e,t)))},contextMenu:C,showContextMenu:(e,t)=>{O({visible:!0,x:t.pageX,y:t.pageY,item:e}),console.log("Context Menu Event - Captured Coords:",{clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY})},hideContextMenu:()=>{O((e=>({...e,visible:!1,item:null})))},editorState:M,openFileEditor:async e=>{if("file"===e.type){j({isOpen:!0,file:e,content:"",isLoading:!0,error:null});try{const t=await(async e=>{const t=`${o}/get-content?path=${encodeURIComponent(e)}`;try{return await a()({path:t,method:"GET"})}catch(e){return console.error("Error getting file content:",e),{success:!1,message:e.message}}})(e.path);if(!t.success)throw new Error(t.message||"Failed to load file content.");j((e=>({...e,content:t.content,isLoading:!1})))}catch(e){console.error("Error loading file content:",e),j((t=>({...t,isLoading:!1,error:e.message})))}}},closeFileEditor:x,saveEditedFile:async()=>{if(M.file){j((e=>({...e,isLoading:!0,error:null})));try{const e=await(async(e,t)=>{try{return await a()({path:`${o}/save-content`,method:"POST",data:{path:e,content:t}})}catch(e){return console.error("Error saving file content:",e),{success:!1,message:e.message}}})(M.file.path,M.content);if(!e.success)throw new Error(e.message||"Failed to save file content.");x(),v(e.message||"File saved successfully!")}catch(e){console.error("Error saving file content:",e),j((t=>({...t,isLoading:!1,error:e.message})))}}},handleEditorContentChange:e=>{j((t=>({...t,content:e})))}};return(0,t.createElement)(c.Provider,{value:P},e)},u=()=>(0,r.useContext)(c),m=window.wp.i18n,d=window.wp.components,f=({onCreateFolder:e,onUpload:r,onDelete:n})=>{const{selectedItems:a,navigateToParent:o,reloadItems:l,currentPath:i}=u();return(0,t.createElement)("div",{className:"rz-file-manager__toolbar"},(0,t.createElement)("div",{className:"rz-file-manager__toolbar-left"},(0,t.createElement)(d.Button,{variant:"secondary",onClick:()=>{o()},icon:"arrow-up-alt2",disabled:!i,className:"rz-file-manager__toolbar-button"},(0,m.__)("Parent Directory","rz-file-manager")),(0,t.createElement)(d.Button,{variant:"secondary",onClick:()=>{l()},icon:"update",className:"rz-file-manager__toolbar-button"},(0,m.__)("Refresh","rz-file-manager"))),(0,t.createElement)("div",{className:"rz-file-manager__toolbar-right"},(0,t.createElement)(d.Button,{variant:"primary",onClick:e,icon:"plus",className:"rz-file-manager__toolbar-button"},(0,m.__)("New Folder","rz-file-manager")),(0,t.createElement)(d.Button,{variant:"primary",onClick:r,icon:"upload",className:"rz-file-manager__toolbar-button"},(0,m.__)("Upload","rz-file-manager")),a.length>0&&(0,t.createElement)(d.Button,{variant:"secondary",onClick:n,icon:"trash",isDestructive:!0,className:"rz-file-manager__toolbar-button"},(0,m.__)("Delete","rz-file-manager"))))},g=()=>{const{currentPath:e,navigateTo:r}=u(),n=(()=>{const t=[{name:(0,m.__)("Root","rz-file-manager"),path:""}];if(!e)return t;const r=e.split("/");let n="";for(let e=0;e<r.length;e++)r[e]&&(n+=(n?"/":"")+r[e],t.push({name:r[e],path:n}));return t})();return(0,t.createElement)("div",{className:"rz-file-manager__breadcrumbs"},n.map(((e,n)=>(0,t.createElement)("span",{key:e.path},n>0&&(0,t.createElement)("span",{className:"rz-file-manager__breadcrumbs-separator"},"/"),(0,t.createElement)("a",{href:"#",className:"rz-file-manager__breadcrumbs-item",onClick:t=>{return n=e.path,t.preventDefault(),void r(n);var n}},e.name)))))},p=({item:e,onRename:r})=>{const{navigateTo:n,toggleSelectItem:a,isItemSelected:o,showContextMenu:l,handleDeleteItems:i,openFileEditor:c}=u();return(0,t.createElement)("tr",{className:"rz-file-manager__file-item "+(o(e)?"is-selected":""),onClick:t=>{const r=t.shiftKey,n=t.ctrlKey||t.metaKey;a(e,r,n)},onDoubleClick:()=>{"directory"===e.type?n(e.path):"file"===e.type&&c(e)},onContextMenu:t=>{t.preventDefault(),l(e,t)}},(0,t.createElement)("td",{className:"rz-file-manager__table-checkbox"},(0,t.createElement)("input",{type:"checkbox",checked:o(e),onChange:t=>{t.stopPropagation(),t.stopPropagation(),a(e)},"aria-label":`Select ${e.name}`})),(0,t.createElement)("td",{className:"rz-file-manager__table-name"},(0,t.createElement)("span",{className:`dashicons dashicons-${(()=>{if("directory"===e.type)return"portfolio";switch(e.name.split(".").pop().toLowerCase()){case"jpg":case"jpeg":case"png":case"gif":case"bmp":return"format-image";case"pdf":return"media-document";case"doc":case"docx":return"media-text";case"xls":case"xlsx":return"media-spreadsheet";case"ppt":case"pptx":return"media-interactive";case"zip":case"rar":case"7z":return"portfolio";case"txt":case"md":return"text-page";default:return"media-default"}})()}`,style:{marginRight:"8px",verticalAlign:"middle"}}),e.name),(0,t.createElement)("td",{className:"rz-file-manager__table-size"},"directory"===e.type?"-":((e,t=2)=>{if(0===e||"number"!=typeof e)return"0 Bytes";const r=t<0?0:t,n=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],a=Math.floor(Math.log(e)/Math.log(1024)),o=a<n.length?a:n.length-1;return parseFloat((e/Math.pow(1024,o)).toFixed(r))+" "+n[o]})(e.size)),(0,t.createElement)("td",{className:"rz-file-manager__table-modified"},(e=>{if(!e||"number"!=typeof e)return"-";try{const t=new Date(1e3*e);return isNaN(t.getTime())?"Invalid Date":t.toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})}catch(e){return console.error("Error formatting date:",e),"Error"}})(e.modified)))},h=({onRename:e})=>{const{items:r,currentPath:n,sortKey:a,sortDirection:o,setSort:l}=u();if(0===r.length)return(0,t.createElement)("div",{className:"rz-file-manager__empty"},(0,t.createElement)("p",null,(0,m.__)("This folder is empty.","rz-file-manager")));const i=e=>{l(e)},c=e=>{if(a!==e)return null;const r="asc"===o?"dashicons dashicons-arrow-up-alt2":"dashicons dashicons-arrow-down-alt2";return(0,t.createElement)("span",{className:r,style:{marginLeft:"5px"}})};return(0,t.createElement)("div",{className:"rz-file-manager__file-list"},(0,t.createElement)("table",{className:"rz-file-manager__table"},(0,t.createElement)("thead",{className:"rz-file-manager__table-head"},(0,t.createElement)("tr",{onClick:e=>e.stopPropagation()}," ",(0,t.createElement)("th",{className:"rz-file-manager__table-checkbox"},(0,t.createElement)("span",{className:"screen-reader-text"},(0,m.__)("Select","rz-file-manager"))),(0,t.createElement)("th",{className:"rz-file-manager__table-name",onClick:()=>i("name")},(0,m.__)("Name","rz-file-manager"),c("name")),(0,t.createElement)("th",{className:"rz-file-manager__table-size",onClick:()=>i("size")},(0,m.__)("Size","rz-file-manager"),c("size")),(0,t.createElement)("th",{className:"rz-file-manager__table-modified",onClick:()=>i("modified")},(0,m.__)("Modified","rz-file-manager"),c("modified")),(0,t.createElement)("th",{className:"rz-file-manager__table-actions"},(0,m.__)("Actions","rz-file-manager")))),(0,t.createElement)("tbody",null,r.map((r=>(0,t.createElement)(p,{key:r.path,item:r,onRename:e}))))))},y=({isOpen:e,onClose:n})=>{const{currentPath:a,handleCreateFolder:o}=u(),[l,i]=(0,r.useState)(""),[c,s]=(0,r.useState)("");return(0,t.createElement)(d.Modal,{title:(0,m.__)("Create New Folder","rz-file-manager"),onRequestClose:n,className:"rz-file-manager__modal"},(0,t.createElement)("form",{onSubmit:e=>{e.preventDefault(),l?/[\\/:*?"<>|]/.test(l)?s((0,m.__)("Folder name contains invalid characters.","rz-file-manager")):(o(l),n()):s((0,m.__)("Please enter a folder name.","rz-file-manager"))}},(0,t.createElement)("div",{className:"rz-file-manager__modal-content"},(0,t.createElement)("p",null,(0,m.__)("Create a new folder in:","rz-file-manager"),(0,t.createElement)("strong",null,a||"/")),(0,t.createElement)(d.TextControl,{label:(0,m.__)("Folder Name","rz-file-manager"),value:l,onChange:e=>{i(e),s("")},placeholder:(0,m.__)("Enter folder name","rz-file-manager"),autoFocus:!0}),c&&(0,t.createElement)("div",{className:"rz-file-manager__modal-error"},c)),(0,t.createElement)("div",{className:"rz-file-manager__modal-footer"},(0,t.createElement)(d.Button,{variant:"secondary",onClick:n},(0,m.__)("Cancel","rz-file-manager")),(0,t.createElement)(d.Button,{variant:"primary",type:"submit"},(0,m.__)("Create Folder","rz-file-manager")))))},E=({isOpen:e,onClose:n,item:a})=>{const{handleRenameItem:o}=u(),[l,i]=(0,r.useState)(""),[c,s]=(0,r.useState)("");return(0,r.useEffect)((()=>{a&&i(a.name)}),[a]),(0,t.createElement)(d.Modal,{title:(0,m.__)("Rename","rz-file-manager"),onRequestClose:n,className:"rz-file-manager__modal"},(0,t.createElement)("form",{onSubmit:e=>{e.preventDefault(),l?/[\\/:*?"<>|]/.test(l)?s((0,m.__)("Name contains invalid characters.","rz-file-manager")):l!==a.name?(o(a.path,l),n()):n():s((0,m.__)("Please enter a name.","rz-file-manager"))}},(0,t.createElement)("div",{className:"rz-file-manager__modal-content"},(0,t.createElement)("p",null,a&&"directory"===a.type?(0,m.__)("Rename folder:","rz-file-manager"):(0,m.__)("Rename file:","rz-file-manager"),(0,t.createElement)("strong",null,a?a.name:"")),(0,t.createElement)(d.TextControl,{label:(0,m.__)("New Name","rz-file-manager"),value:l,onChange:e=>{i(e),s("")},placeholder:(0,m.__)("Enter new name","rz-file-manager"),autoFocus:!0}),c&&(0,t.createElement)("div",{className:"rz-file-manager__modal-error"},c)),(0,t.createElement)("div",{className:"rz-file-manager__modal-footer"},(0,t.createElement)(d.Button,{variant:"secondary",onClick:n},(0,m.__)("Cancel","rz-file-manager")),(0,t.createElement)(d.Button,{variant:"primary",type:"submit"},(0,m.__)("Rename","rz-file-manager")))))},v=({isOpen:e,onClose:r})=>{const{selectedItems:n,handleDeleteItems:a}=u();return(0,t.createElement)(d.Modal,{title:(0,m.__)("Confirm Deletion","rz-file-manager"),onRequestClose:r,className:"rz-file-manager__modal"},(0,t.createElement)("div",{className:"rz-file-manager__modal-content"},(0,t.createElement)("p",null,(()=>{const e=n.filter((e=>"directory"!==e.type)).length,t=n.filter((e=>"directory"===e.type)).length;return e>0&&t>0?(0,m.__)(`Are you sure you want to delete ${e} file(s) and ${t} folder(s)? This action cannot be undone.`,"rz-file-manager"):e>0?(0,m.__)(`Are you sure you want to delete ${e} file(s)? This action cannot be undone.`,"rz-file-manager"):t>0?(0,m.__)(`Are you sure you want to delete ${t} folder(s) and all their contents? This action cannot be undone.`,"rz-file-manager"):(0,m.__)("Are you sure you want to delete the selected items? This action cannot be undone.","rz-file-manager")})()),(0,t.createElement)("ul",{className:"rz-file-manager__delete-list"},n.map((e=>(0,t.createElement)("li",{key:e.path},(0,t.createElement)("strong",null,e.name),"directory"===e.type?` (${(0,m.__)("Folder","rz-file-manager")})`:""))))),(0,t.createElement)("div",{className:"rz-file-manager__modal-footer"},(0,t.createElement)(d.Button,{variant:"secondary",onClick:r},(0,m.__)("Cancel","rz-file-manager")),(0,t.createElement)(d.Button,{variant:"primary",onClick:()=>{a(),r()},isDestructive:!0},(0,m.__)("Delete","rz-file-manager"))))};function _(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){_(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){C(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function j(e){return function t(){for(var r=this,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return a.length>=e.length?e.apply(this,a):function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.apply(r,[].concat(a,n))}}}function N(e){return{}.toString.call(e).includes("Object")}function S(e){return"function"==typeof e}var k=j((function(e,t){throw new Error(e[t]||e.default)}))({initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"}),x=function(e,t){return N(t)||k("changeType"),Object.keys(t).some((function(t){return r=e,n=t,!Object.prototype.hasOwnProperty.call(r,n);var r,n}))&&k("changeField"),t},P=function(e){S(e)||k("selectorType")},R=function(e){S(e)||N(e)||k("handlerType"),N(e)&&Object.values(e).some((function(e){return!S(e)}))&&k("handlersType")},F=function(e){var t;e||k("initialIsRequired"),N(e)||k("initialType"),t=e,Object.keys(t).length||k("initialContent")};function T(e,t){return S(t)?t(e.current):t}function D(e,t){return e.current=M(M({},e.current),t),t}function I(e,t,r){return S(t)?t(e.current):Object.keys(r).forEach((function(r){var n;return null===(n=t[r])||void 0===n?void 0:n.call(t,e.current[r])})),r}const L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};F(e),R(t);var r={current:e},n=j(I)(r,t),a=j(D)(r),o=j(x)(e),l=j(T)(r);return[function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e};return P(e),e(r.current)},function(e){!function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}}(n,a,o,l)(e)}]};var B,$={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:"Deprecation warning!\n    You are using deprecated way of configuration.\n\n    Instead of using\n      monaco.config({ urls: { monacoBase: '...' } })\n    use\n      monaco.config({ paths: { vs: '...' } })\n\n    For more please check the link https://github.com/suren-atoyan/monaco-loader#config\n  "},A=(B=function(e,t){throw new Error(e[t]||e.default)},function e(){for(var t=this,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return n.length>=B.length?B.apply(this,n):function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e.apply(t,[].concat(n,a))}})($);const U={config:function(e){return e||A("configIsRequired"),t=e,{}.toString.call(t).includes("Object")||A("configType"),e.urls?(console.warn($.deprecation),{paths:{vs:e.urls.monacoBase}}):e;var t}},q=function e(t,r){return Object.keys(r).forEach((function(n){r[n]instanceof Object&&t[n]&&Object.assign(r[n],e(t[n],r[n]))})),w(w({},t),r)};var V={type:"cancelation",msg:"operation is manually canceled"};const X=function(e){var t=!1,r=new Promise((function(r,n){e.then((function(e){return t?n(V):r(e)})),e.catch(n)}));return r.cancel=function(){return t=!0},r};var Y,K=function(e){if(Array.isArray(e))return e}(Y=L({config:{paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}},isInitialized:!1,resolve:null,reject:null,monaco:null}))||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var t=[],_n=!0,r=!1,n=void 0;try{for(var a,o=e[Symbol.iterator]();!(_n=(a=o.next()).done)&&(t.push(a.value),2!==t.length);_n=!0);}catch(e){r=!0,n=e}finally{try{_n||null==o.return||o.return()}finally{if(r)throw n}}return t}}(Y)||function(e){if(e){if("string"==typeof e)return z(e,2);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?z(e,2):void 0}}(Y)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),G=K[0],W=K[1];function H(e){return document.body.appendChild(e)}function Z(e){var t,r,n=G((function(e){return{config:e.config,reject:e.reject}})),a=(t="".concat(n.config.paths.vs,"/loader.js"),r=document.createElement("script"),t&&(r.src=t),r);return a.onload=function(){return e()},a.onerror=n.reject,a}function J(){var e=G((function(e){return{config:e.config,resolve:e.resolve,reject:e.reject}})),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],(function(t){Q(t),e.resolve(t)}),(function(t){e.reject(t)}))}function Q(e){G().monaco||W({monaco:e})}var ee=new Promise((function(e,t){return W({resolve:e,reject:t})})),te={config:function(e){var t=U.config(e),r=t.monaco,n=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(t,["monaco"]);W((function(e){return{config:q(e.config,n),monaco:r}}))},init:function(){var e=G((function(e){return{monaco:e.monaco,isInitialized:e.isInitialized,resolve:e.resolve}}));if(!e.isInitialized){if(W({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),X(ee);if(window.monaco&&window.monaco.editor)return Q(window.monaco),e.resolve(window.monaco),X(ee);!function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}}(H,Z)(J)}return X(ee)},__getMonacoInstance:function(){return G((function(e){return e.monaco}))}};const re=te;var ne={display:"flex",position:"relative",textAlign:"initial"},ae={width:"100%"},oe={display:"none"},le={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},ie=function({children:e}){return t.createElement("div",{style:le.container},e)},ce=(0,t.memo)((function({width:e,height:r,isEditorReady:n,loading:a,_ref:o,className:l,wrapperProps:i}){return t.createElement("section",{style:{...ne,width:e,height:r},...i},!n&&t.createElement(ie,null,a),t.createElement("div",{ref:o,style:{...ae,...!n&&oe},className:l}))})),se=function(e){(0,t.useEffect)(e,[])},ue=function(e,r,n=!0){let a=(0,t.useRef)(!0);(0,t.useEffect)(a.current||!n?()=>{a.current=!1}:e,r)};function me(){}function de(e,t,r,n){return function(e,t){return e.editor.getModel(fe(e,t))}(e,n)||function(e,t,r,n){return e.editor.createModel(t,r,n?fe(e,n):void 0)}(e,t,r,n)}function fe(e,t){return e.Uri.parse(t)}(0,t.memo)((function({original:e,modified:r,language:n,originalLanguage:a,modifiedLanguage:o,originalModelPath:l,modifiedModelPath:i,keepCurrentOriginalModel:c=!1,keepCurrentModifiedModel:s=!1,theme:u="light",loading:m="Loading...",options:d={},height:f="100%",width:g="100%",className:p,wrapperProps:h={},beforeMount:y=me,onMount:E=me}){let[v,_]=(0,t.useState)(!1),[b,w]=(0,t.useState)(!0),z=(0,t.useRef)(null),C=(0,t.useRef)(null),O=(0,t.useRef)(null),M=(0,t.useRef)(E),j=(0,t.useRef)(y),N=(0,t.useRef)(!1);se((()=>{let e=re.init();return e.then((e=>(C.current=e)&&w(!1))).catch((e=>"cancelation"!==e?.type&&console.error("Monaco initialization: error:",e))),()=>z.current?function(){let e=z.current?.getModel();c||e?.original?.dispose(),s||e?.modified?.dispose(),z.current?.dispose()}():e.cancel()})),ue((()=>{if(z.current&&C.current){let t=z.current.getOriginalEditor(),r=de(C.current,e||"",a||n||"text",l||"");r!==t.getModel()&&t.setModel(r)}}),[l],v),ue((()=>{if(z.current&&C.current){let e=z.current.getModifiedEditor(),t=de(C.current,r||"",o||n||"text",i||"");t!==e.getModel()&&e.setModel(t)}}),[i],v),ue((()=>{let e=z.current.getModifiedEditor();e.getOption(C.current.editor.EditorOption.readOnly)?e.setValue(r||""):r!==e.getValue()&&(e.executeEdits("",[{range:e.getModel().getFullModelRange(),text:r||"",forceMoveMarkers:!0}]),e.pushUndoStop())}),[r],v),ue((()=>{z.current?.getModel()?.original.setValue(e||"")}),[e],v),ue((()=>{let{original:e,modified:t}=z.current.getModel();C.current.editor.setModelLanguage(e,a||n||"text"),C.current.editor.setModelLanguage(t,o||n||"text")}),[n,a,o],v),ue((()=>{C.current?.editor.setTheme(u)}),[u],v),ue((()=>{z.current?.updateOptions(d)}),[d],v);let S=(0,t.useCallback)((()=>{if(!C.current)return;j.current(C.current);let t=de(C.current,e||"",a||n||"text",l||""),c=de(C.current,r||"",o||n||"text",i||"");z.current?.setModel({original:t,modified:c})}),[n,r,o,e,a,l,i]),k=(0,t.useCallback)((()=>{!N.current&&O.current&&(z.current=C.current.editor.createDiffEditor(O.current,{automaticLayout:!0,...d}),S(),C.current?.editor.setTheme(u),_(!0),N.current=!0)}),[d,u,S]);return(0,t.useEffect)((()=>{v&&M.current(z.current,C.current)}),[v]),(0,t.useEffect)((()=>{!b&&!v&&k()}),[b,v,k]),t.createElement(ce,{width:g,height:f,isEditorReady:v,loading:m,_ref:O,className:p,wrapperProps:h})}));var ge=new Map,pe=(0,t.memo)((function({defaultValue:e,defaultLanguage:r,defaultPath:n,value:a,language:o,path:l,theme:i="light",line:c,loading:s="Loading...",options:u={},overrideServices:m={},saveViewState:d=!0,keepCurrentModel:f=!1,width:g="100%",height:p="100%",className:h,wrapperProps:y={},beforeMount:E=me,onMount:v=me,onChange:_,onValidate:b=me}){let[w,z]=(0,t.useState)(!1),[C,O]=(0,t.useState)(!0),M=(0,t.useRef)(null),j=(0,t.useRef)(null),N=(0,t.useRef)(null),S=(0,t.useRef)(v),k=(0,t.useRef)(E),x=(0,t.useRef)(),P=(0,t.useRef)(a),R=function(e){let r=(0,t.useRef)();return(0,t.useEffect)((()=>{r.current=e}),[e]),r.current}(l),F=(0,t.useRef)(!1),T=(0,t.useRef)(!1);se((()=>{let e=re.init();return e.then((e=>(M.current=e)&&O(!1))).catch((e=>"cancelation"!==e?.type&&console.error("Monaco initialization: error:",e))),()=>j.current?(x.current?.dispose(),f?d&&ge.set(l,j.current.saveViewState()):j.current.getModel()?.dispose(),void j.current.dispose()):e.cancel()})),ue((()=>{let t=de(M.current,e||a||"",r||o||"",l||n||"");t!==j.current?.getModel()&&(d&&ge.set(R,j.current?.saveViewState()),j.current?.setModel(t),d&&j.current?.restoreViewState(ge.get(l)))}),[l],w),ue((()=>{j.current?.updateOptions(u)}),[u],w),ue((()=>{!j.current||void 0===a||(j.current.getOption(M.current.editor.EditorOption.readOnly)?j.current.setValue(a):a!==j.current.getValue()&&(T.current=!0,j.current.executeEdits("",[{range:j.current.getModel().getFullModelRange(),text:a,forceMoveMarkers:!0}]),j.current.pushUndoStop(),T.current=!1))}),[a],w),ue((()=>{let e=j.current?.getModel();e&&o&&M.current?.editor.setModelLanguage(e,o)}),[o],w),ue((()=>{void 0!==c&&j.current?.revealLine(c)}),[c],w),ue((()=>{M.current?.editor.setTheme(i)}),[i],w);let D=(0,t.useCallback)((()=>{if(N.current&&M.current&&!F.current){k.current(M.current);let t=l||n,s=de(M.current,a||e||"",r||o||"",t||"");j.current=M.current?.editor.create(N.current,{model:s,automaticLayout:!0,...u},m),d&&j.current.restoreViewState(ge.get(t)),M.current.editor.setTheme(i),void 0!==c&&j.current.revealLine(c),z(!0),F.current=!0}}),[e,r,n,a,o,l,u,m,d,i,c]);return(0,t.useEffect)((()=>{w&&S.current(j.current,M.current)}),[w]),(0,t.useEffect)((()=>{!C&&!w&&D()}),[C,w,D]),P.current=a,(0,t.useEffect)((()=>{w&&_&&(x.current?.dispose(),x.current=j.current?.onDidChangeModelContent((e=>{T.current||_(j.current.getValue(),e)})))}),[w,_]),(0,t.useEffect)((()=>{if(w){let e=M.current.editor.onDidChangeMarkers((e=>{let t=j.current.getModel()?.uri;if(t&&e.find((e=>e.path===t.path))){let e=M.current.editor.getModelMarkers({resource:t});b?.(e)}}));return()=>{e?.dispose()}}return()=>{}}),[w,b]),t.createElement(ce,{width:g,height:p,isEditorReady:w,loading:s,_ref:N,className:h,wrapperProps:y})}));const he=()=>{const{editorState:e,closeFileEditor:r,saveEditedFile:n,handleEditorContentChange:a}=u();if(!e.isOpen)return null;const{file:o,content:l,isLoading:i,error:c}=e,s=(e=>{if(!e)return"plaintext";const t=e.split(".").pop()?.toLowerCase();switch(t){case"js":case"jsx":return"javascript";case"ts":case"tsx":return"typescript";case"css":return"css";case"scss":return"scss";case"less":return"less";case"html":return"html";case"json":return"json";case"php":return"php";case"md":return"markdown";case"yaml":case"yml":return"yaml";case"xml":return"xml";case"py":return"python";case"sql":return"sql";default:return"plaintext"}})(o?.name);return(0,t.createElement)(d.Modal,{title:o?`${(0,m.__)("Edit File","rz-file-manager")}: ${o.name}`:(0,m.__)("Edit File","rz-file-manager"),onRequestClose:r,className:"rz-file-manager-editor-modal",shouldCloseOnClickOutside:!1,isDismissible:!i},i&&!l&&(0,t.createElement)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px"}},(0,t.createElement)(d.Spinner,null)),!i&&c&&(0,t.createElement)("div",{className:"rz-file-manager-editor-modal__error",style:{color:"red",marginBottom:"1em"}},(0,t.createElement)("p",null,(0,t.createElement)("strong",null,(0,m.__)("Error","rz-file-manager"),":")," ",c)),(!i||l)&&!c&&(0,t.createElement)(pe,{height:"60vh",language:s,value:l,theme:"vs-light",options:{lineNumbers:"on",minimap:{enabled:!1},wordWrap:"on",scrollBeyondLastLine:!1,readOnly:i},onChange:a,onMount:(e,t)=>{}}),(0,t.createElement)("div",{className:"rz-file-manager-editor-modal__actions",style:{marginTop:"1em",display:"flex",justifyContent:"flex-end"}},(0,t.createElement)(d.Button,{isSecondary:!0,onClick:r,disabled:i,style:{marginRight:"8px"}},(0,m.__)("Cancel","rz-file-manager")),(0,t.createElement)(d.Button,{isPrimary:!0,onClick:n,isBusy:i,disabled:i||!!c},(0,m.__)("Save Changes","rz-file-manager"))))},ye=window.ReactDOM,Ee=()=>{const{contextMenu:e,hideContextMenu:r,openFileEditor:n}=u(),a=(0,t.useRef)(null);if((0,t.useEffect)((()=>{const t=e=>{a.current&&!a.current.contains(e.target)&&r()};return e.visible?document.addEventListener("mousedown",t):document.removeEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}}),[e.visible,r]),!e.visible||!e.item)return null;const o={position:"absolute",top:`${e.y}px`,left:`${e.x}px`,zIndex:1e3},l=(0,t.createElement)("div",{ref:a,className:"rz-file-manager-context-menu",style:o},console.log("Context Menu Applied Style:",o),(0,t.createElement)("ul",null,"file"===e.item.type&&(0,t.createElement)("li",null,(0,t.createElement)("button",{onClick:()=>{e.item&&"file"===e.item.type&&n(e.item),r()}},(0,t.createElement)("span",{className:"dashicons dashicons-edit",style:{marginRight:"5px"}})," ",(0,m.__)("Edit","rz-file-manager"))),(0,t.createElement)("li",null,(0,t.createElement)("button",{onClick:()=>{console.log("Rename clicked for:",e.item.name),r()}},(0,t.createElement)("span",{className:"dashicons dashicons-edit",style:{marginRight:"5px"}})," Rename")),(0,t.createElement)("li",null,(0,t.createElement)("button",{onClick:()=>(console.log("Delete clicked for:",e.item.name),void r()),style:{color:"red"}},(0,t.createElement)("span",{className:"dashicons dashicons-trash",style:{marginRight:"5px"}})," Delete"))));return(0,ye.createPortal)(l,document.body)},ve=()=>{const{loading:e,error:n,clearError:a,successMessage:o,clearMessages:l,hideContextMenu:i}=u(),[c,s]=(0,r.useState)(!1),[m,p]=(0,r.useState)(!1),[_,b]=(0,r.useState)(!1),[w,z]=(0,r.useState)(!1),[C,O]=(0,r.useState)(null);return(0,t.createElement)("div",{className:"rz-file-manager",onClick:()=>{i()}},n&&(0,t.createElement)("div",{className:"rz-file-manager__error"},(0,t.createElement)("p",null,n),(0,t.createElement)("button",{onClick:l},"×")),o&&(0,t.createElement)("div",{className:"rz-file-manager__success"},(0,t.createElement)("p",null,o),(0,t.createElement)("button",{onClick:l},"×")),(0,t.createElement)(f,{onCreateFolder:()=>{s(!0)},onDelete:()=>{z(!0)}}),(0,t.createElement)(g,null),e?(0,t.createElement)("div",{className:"rz-file-manager__loading"},(0,t.createElement)(d.Spinner,null)):(0,t.createElement)(h,{onRename:e=>{O(e),b(!0)}}),c&&(0,t.createElement)(y,{isOpen:c,onClose:()=>s(!1)}),_&&C&&(0,t.createElement)(E,{isOpen:_,onClose:()=>b(!1),item:C}),w&&(0,t.createElement)(v,{isOpen:w,onClose:()=>z(!1)}),(0,t.createElement)(Ee,null),(0,t.createElement)(he,null))},_e=()=>(0,t.createElement)(s,null,(0,t.createElement)("div",{className:"rz-file-manager-app"},(0,t.createElement)(ve,null)));document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("rz-file-manager-root");e&&(0,r.render)((0,t.createElement)(s,null,(0,t.createElement)(_e,null)),e)}))})();